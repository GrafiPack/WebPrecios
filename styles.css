const sheetID = "1p3Q-DpF8JcdGIWwOns7rirsgoVJ6LES2LzaBgGE42XI";
const sheetName = "Hoja 1";
const url = `https://opensheet.elk.sh/${sheetID}/${sheetName}`;

const encabezadosPorCategoria = {
  "Folletos": {
    Precio1: "1000 u.",
    Precio2: "3000 u.",
    Precio3: "5000 u."
  },
  "Tarjetas": {
    Precio1: "1000 tarjetas",
    Precio2: "2000 tarjetas",
    Precio3: "5000 tarjetas"
  }
};

fetch(url)
  .then((res) => res.json())
  .then((data) => {
    const container = document.getElementById("precios-container");
    const dataFiltrada = data.filter(row => row.Categoría !== "Categoría");

    const grouped = {};
    dataFiltrada.forEach(row => {
      const categoria = row['Categoría'] || "Sin categoría";
      const subcategoria = row['Subcategoría'] || "Sin subcategoría";

      if (!grouped[categoria]) grouped[categoria] = {};
      if (!grouped[categoria][subcategoria]) grouped[categoria][subcategoria] = [];

      grouped[categoria][subcategoria].push(row);
    });

    for (const categoria in grouped) {
      // ✅ Crear el título de categoría UNA VEZ antes de recorrer subcategorías
      const catEl = document.createElement("div");
      catEl.className = "category-title";
      catEl.textContent = categoria;
      container.appendChild(catEl);

      for (const subcategoria in grouped[categoria]) {
        const productos = grouped[categoria][subcategoria];

        const columnasPrecio = Object.keys(productos[0])
          .filter(key => key.startsWith("Precio"))
          .filter(key => productos.some(p => p[key] &&
